<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 4.8.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="J. Lyle Kim">

  
  
  
    
  
  <meta name="description" content="Read more">

  
  <link rel="alternate" hreflang="en-us" href="https://jlylekim.github.io/blog/sppam/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#118AB2">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400%7CZen+Antique%7CDM+Mono:400%7COpen+Sans:400&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu6a253511a905c4c58ef48adc8d74e746_25674_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu6a253511a905c4c58ef48adc8d74e746_25674_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://jlylekim.github.io/blog/sppam/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="JUNHYUNG LYLE KIM">
  <meta property="og:url" content="https://jlylekim.github.io/blog/sppam/">
  <meta property="og:title" content="Convergence and stability of the stochastic proximal point algorithm with momentum | JUNHYUNG LYLE KIM">
  <meta property="og:description" content="Read more"><meta property="og:image" content="https://jlylekim.github.io/blog/sppam/featured.png">
  <meta property="twitter:image" content="https://jlylekim.github.io/blog/sppam/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2022-04-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2022-04-01T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Convergence and stability of the stochastic proximal point algorithm with momentum | JUNHYUNG LYLE KIM</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" ">

  
  
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">JUNHYUNG LYLE KIM</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">JUNHYUNG LYLE KIM</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>HOME</span></a>
        </li>

        
        

        

        
        
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/blog"><span>BLOG</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>RESEARCH</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>CONTACT</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      

      
      

      

    </ul>

  </div>
</nav>



  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Convergence and stability of the stochastic proximal point algorithm with momentum</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span ><a href="/author/j.-lyle-kim/">J. Lyle Kim</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Apr 1, 2022
  </span>
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/convex-optimization/">convex optimization</a>, <a href="/category/acceleration/">acceleration</a>, <a href="/category/proximal-point-algorithm/">proximal point algorithm</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="introduction">Introduction</h2>
<p>In this blog post, I will introduce the stochastic proximal point algorithm with momentum (SPPAM) based on <a href="https://arxiv.org/abs/2111.06171" target="_blank" rel="noopener">this paper</a>,<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> which is forthcoming in <a href="https://l4dc.stanford.edu" target="_blank" rel="noopener">Learning for Dynamics and Control (L4DC) 2022</a>.</p>
<h3 id="background">Background</h3>
<p>We focus on unconstrained empirical risk minimization:
\begin{align}
\label{eq:obj} \tag{1}
\min_{x \in \mathbb{R}^p} ~f(x) = \frac{1}{n} \sum_{i=1}^n f_i(x).
\end{align}</p>
<p>Stochastic gradient descent (SGD) has become the de facto method to solve \eqref{eq:obj} used by the machine learning community, mainly due to its computational efficiency. SGD iterates as follows:
\begin{align}
\label{eq:sgd} \tag{2}
x_{t+1} = x_t  - \eta \nabla f_{i_t}(x_t),
\end{align}
where $\eta$ is the step size, and $\nabla f_i$ is the (stochastic) gradient computed at the $i$-th data point.</p>
<!-- #### Properties of SGD and Its Momentum Extension. -->
<p>While computationally efficient, SGD in \eqref{eq:sgd} suffers from two major limitations: $(i)$ slow convergence, and $(ii)$ numerical instability.
Due to the (stochastic) gradient noise, SGD could take longer to converge in terms of iterations.
Moreover, SGD suffers from numerical instabilities both in theory and practice, allowing only a small range of $\eta$ values that lead to convergence, which often depend on unknown quantities. <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></p>
<h3 id="acceleration-via-momentum">Acceleration via Momentum.</h3>
<p>With respect to the slow convergence, many variants of accelerated methods have been proposed, including the Polyak&rsquo;s momentum <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> and the Nesterov&rsquo;s acceleration <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup> methods.
These methods allow faster (sometimes optimal) convergence rates, while having virtually the same computational cost as SGD.
In particular, SGD with momentum (SGDM) iterates as follows:
\begin{align}
\label{eq:sgdm} \tag{3}
x_{t+1} = x_t  - \eta \nabla f_{i_t}(x_t) + \beta (x_t - x_{t-1}),
\end{align}
where $\beta \in [0,1)$ is the momentum parameter.
The intuition is that, if the direction from $x_{t-1}$ to $x_t$ was &ldquo;correct,&rdquo; then SGDM utilizes this inertia weighted by the momentum parameter $\beta,$ instead of just relying on the current point $x_t.$</p>
<!-- Much of the state-of-the-art performance has been achieved with SGDM \citep{huang2017densely, howard2017mobilenets, he2016deep}. -->
<p>Yet, SGDM could be hard to tune: SGDM adds another hyperparameter&mdash;momentum $\beta$&mdash;to an already sensitive stochastic procedure of SGD.
As such, various works have found that such motions could aggravate the instability of SGD. <sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>  <sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> <sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup></p>
<!-- For instance, \cite{liu_accelerating_2019} and \cite{kidambi_insufficiency_2018} show that accelerated SGD does not in general provide any acceleration over SGD, regardless of careful tuning; further, accelerated SGD may diverge for the step sizes that SGD converges.  -->
<!-- \cite{assran_convergence_2020} also show that, even with finite-sum of quadratic functions, accelerated SGD may diverge under the usual choices of step size and momentum. -->
<!-- See also \cite{loizou2020momentum, devolder2014first, d2008smooth} for more discussions on this topic. -->
<h3 id="stability-via-proximal-updates">Stability via Proximal Updates.</h3>
<p>With respect to the numerical stability, variants of SGD that utilize proximal updates have recently been proposed.
The proximal point algorithm (PPA) obtains the next iterate for minimizing $f$ by solving the following optimization problem:
\begin{align}
\label{eq:ppa} \tag{6}
x_{t+1} = \arg \min_{x\in \mathbb{R}^p} \left\{ f(x) + \tfrac{1}{2\eta} || x - x_t ||_2^2 \right\},
\end{align}
which is equivalent to implicit gradient descent (IGD) by the first-order optimality condition:
\begin{align}
\label{eq:igd} \tag{7}
x_{t+1} = x_t - \eta \nabla f(x_{t+1}).
\end{align}
In words, instead of minimizing $f$ directly, PPA minimizes $f$ with an additional quadratic term.
This small change brings a major advantage to PPA: if $f$ is convex, the added quadratic term can make the problem strongly convex; if $f$ is non-convex, PPA can make it convex.</p>
<!-- \citep{ahn_proximal_2020}. -->
<p>Thanks to this conditioning property, PPA exhibits different behavior compared to GD in the deterministic setting.
For a convex function $f$, PPA satisfies: <sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup>
\begin{align}
\label{eq:ppm-conv-rate-guller} \tag{8}
f(x_T) - f(x^\star) \leq O \left( \tfrac{1}{\sum_{t=1}^T \eta_t} \right),<br>
\end{align}
after $T$ iterations.
By setting the step size $\eta_t$ to be large, PPA can converge ``arbitrarily'' fast.</p>
<p>Due to this remarkable property, PPA was soon considered in the stochastic setting, dubbed as stochastic proximal iterations (SPI) <sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup> <sup id="fnref:11"><a href="#fn:11" class="footnote-ref" role="doc-noteref">11</a></sup> or implicit SGD <sup id="fnref:12"><a href="#fn:12" class="footnote-ref" role="doc-noteref">12</a></sup> <sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup>.
These works generally indicate that, in the asymptotic regime, SGD and SPI/ISGD have the same convergence behavior; but in the non-asymptotic regime, SPI/ISGD outperforms SGD due to numerical stability provided by utilizing proximal updates.</p>
<!-- In the stochastic setting, \cite{toulis_proximal_2021} show that
SPPA enjoys an exponential discount of the initial condition, regardless of the step size $\eta$ and the smoothness parameter $L$. 
On the contrary, for SGD, 
both $\eta$ and $L$ show up within an exponential term, amplifying the initial conditions, leading to even divergence if misspecified \citep{moulines_non-asymptotic_2011}. -->
<!-- In particular, \cite{toulis_proximal_2021} introduced stochastic errors in proximal point algorithms (SPPA) and analyzed its convergence and stability, which iterates similar to: 
\begin{align}
    x_{t+1} &= x_t - \eta \left( \nabla f(x_{t+1}) + \varepsilon_{t+1} \right)   \label{eq:stoc-ppa}. \tag{4}
\end{align}
Without stochastic errors, \eqref{eq:stoc-ppa} is known as the proximal point algorithm (PPA) \citep{rockafellar_monotone_1976, guler_convergence_1991} or the implicit gradient descent (IGD).  -->
<!-- PPA/IGD is known to converge with minimal assumptions on hyperparameter tuning, by improving the conditioning of the optimization problem; more details in Section~\ref{sec:prelim}. -->
<h3 id="our-approach-stochastic-ppa-with-momentum-sppam">Our Approach: Stochastic PPA with Momentum (SPPAM).</h3>
<p>The main question we wanted to answer in this work was as follows:
$$\text{Can we accelerate stochastic PPA while preserving its numerical stability?}$$</p>
<!-- To address both issues, we introduce stochastic PPA with momentum (SPPAM), and study its convergence and stability b...ehavior. SPPAM directly incorporates the momentum term akin to \eqref{eq:sgdm} into \eqref{eq:stoc-ppa}:  -->
<p>SPPAM iterates as follows:
\begin{align}
x_{t+1} &amp;= x_t - \eta \left (\nabla f(x_{t+1}) + \varepsilon_{t+1}\right) + \beta (x_t - x_{t-1})  \label{eq:acc-stoc-ppa}. \tag{5}
\end{align}</p>
<!-- \paragraph{Our Focus and Contributions.} -->
<!-- #### Our Focus and Contributions. -->
<!-- Stochastic accelerated variants of PPA have received limited attention: how momentum interacts with the stability that PPA provides remains unstudied. 
To the best of our knowledge, \textit{no momentum has been considered for stochastic proximal point updates that, beyond convergence, also studies the stability of the acceleration motions.}
This is the aim of this work. 
Our contributions are summarized as:
- We introduce stochastic PPA with momentum (SPPAM), and study its convergence and stability behavior. SPPAM directly incorporates the momentum term akin to \eqref{eq:sgdm} into \eqref{eq:stoc-ppa}: 
  \begin{align}
    x_{t+1} &= x_t - \eta \left (\nabla f(x_{t+1}) + \varepsilon_{t+1}\right) + \beta (x_t - x_{t-1})  \label{eq:acc-stoc-ppa}. \tag{5} 
  \end{align}
- We study whether adding momentum $\beta$ results in faster convergence akin to SGDM, while preserving the numerical stability, inherited by utilizing proximal updates akin to SPPA. 
- We show that SPPAM enjoys linear convergence to a neighborhood (Theorem \ref{thm:lin-conv}) with a better contraction factor than SPPA (Lemma \ref{lem:SPPAM-contraction}). We further characterize the conditions on $\eta$ and $\beta$ that result in acceleration (Corollay \ref{cor:acc-condition}). 
Finally, we characterize the condition that leads to the exponential discount of initial conditions for SPPAM (Theorem~\ref{thm:init-discount-condition}), which is significantly easier to satisfy compared to SGDM.
- Empirically, we confirm our theory with experiments on generalized linear models (GLM), including
linear and Poisson regressions with different condition numbers. 
As expected, SGD and SGDM converge only for specific choices of $\eta$ and $\beta$, while SPPA converges for a much wider range of $\eta.$ 
SPPAM enjoys the advantages of both acceleration from the momentum and stability from the proximal step: it converges for the range of $\eta$ that SPPA converges but with faster rate, which improves or matches that of SGDM, when the latter converges.
\end{itemize} -->
<!-- ## Preliminaries -->
<!-- #### Accelerated PPA
Accelerated PPA was first proposed in deterministic setting in \cite{guler_new_1992}, where Nesterov's acceleration was applied \emph{after} solving the proximal step in \eqref{eq:ppa}. This yields the convergence rate of the form: 
\begin{align}
    f(x_T) - f(x^\star) \leq O \left( \frac{1}{ \big( \sum_{t=1}^T \sqrt{\eta_t} \big)^2} \right), \label{eq:ppm-acc-conv-rate-guller} \tag{9}
\end{align}
which is faster than the rate in \eqref{eq:ppm-conv-rate-guller}. 
This bound is based on Nesterov's momentum schedules, but does not study the effect in stability different tuning pairs $(\eta, \beta)$ might have. 
Moreover, as can be seen in \eqref{eq:ppm-conv-rate-guller}, PPA can already achieve arbitrarily fast convergence, given it is implemented exactly.
Hence, following works focused on studying the conditions under which the proximal step in \eqref{eq:ppa} can be computed inexactly, while still exhibiting some acceleration \citep{lin_universal_2015, lin_catalyst_2018}; similar analyses were later extended to the stochastic setting in \cite{kulunchakov_generic_2019}.


\cite{chadha_accelerated_2021} and \cite{deng_minibatch_2021} also considered accelerated SPPA.
Both of these works apply a convoluted 2- or 3-step Nesterov's procedure after the proximal step, where $f_i$ was further approximated with auxiliary functions. 
Yet, stability arguments via proximal updates are less apparent due to the auxiliary functions, requiring specific step size and momentum schedules, which might involve an additional one-dimensional optimization per iteration; see also Theorem~\ref{thm:init-discount-condition}.
A summary of these algorithms is provided in the table below.







  



  
  











<figure id="figure-summary-of-related-works">


  <a data-fancybox="" href="/blog/sppam/related-work_hu8fc69290f50e18d7a3ab267652c95375_201924_2000x2000_fit_lanczos_2.png" data-caption="Summary of related works">


  <img data-src="/blog/sppam/related-work_hu8fc69290f50e18d7a3ab267652c95375_201924_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="100%" height="873">
</a>


  
  
  <figcaption>
    Summary of related works
  </figcaption>


</figure>
 -->
<!-- #### Intuition of SPPAM in \eqref{eq:acc-stoc-ppa} -->
<!-- In contrast to the aforementioned works, we include Polyak's momentum \citep{polyak_methods_1964} directly to SPPA, yielding \eqref{eq:acc-stoc-ppa}.  -->
<p>Apart from the similarity between SPPAM in \eqref{eq:acc-stoc-ppa} and SGDM in \eqref{eq:sgdm}, SPPAM shares the same geometric intuition as Polyak&rsquo;s momentum for SGDM.
Disregarding the stochastic errors, the update in \eqref{eq:acc-stoc-ppa} follows from the solution of:
\begin{align*}
\arg \min_{x \in \mathbb{R}^p} \left\{ f(x) + \tfrac{1}{2\eta} ||x-x_t||_2^2 - \tfrac{\beta}{\eta} \langle x_t - x_{t-1}, x \rangle \right\}.
\end{align*}</p>
<p>We can get a sense of the behavior of SPPAM from this expression.
First, for large $\eta$, the algorithm is minimizing the original $f.$
For small $\eta$, the algorithm not only tries to stay local by minimizing the quadratic term, but also tries to minimize
$-\frac{\beta}{\eta} \langle x_t - x_{t-1}, x \rangle$.
By the definition of inner product, this means that $x$, on top of minimizing $f$ and staying close to $x_t$, also tries to move along the direction from $x_{t-1}$ to $x_t$. This intuition aligns with that of Polyak&rsquo;s momentum.</p>
<h2 id="the-quadratic-model-case">The quadratic model case</h2>
<p>For simplicity, we first consider the convex quadratic optimization problem under the deterministic setting.
Specifically, we consider the objective function:
\begin{align}
\label{eq:obj-quad} \tag{10}
f(x) = \frac{1}{2} x^\top A x - b^\top x,
\end{align}
where $A \in \mathbb{R}^{p\times p}$ is positive semi-definite with eigenvalues $\left[ \lambda_1, \dots, \lambda_p \right]$.
Under this scenario,
we can study how the step size $\eta$ and the momentum $\beta$ affect each other, by deriving exact conditions that lead to convergence for each algorithm.
The comparison list includes
gradient descent (GD), gradient descent with momentum (GDM), the PPA, and PPA with momentum (PPAM).</p>
<!-- Propositions~\ref{prop:gd} and \ref{prop:gdm} for GD and GDM are from {{\cite{goh2017why}}}, and included for completeness.  -->
<!-- Propositions 1 and 3 for GD and GDM are from {{\cite{goh2017why}}}, and included for completeness.
Proofs for PPA and PPAM in Propositions 2 and 4 can be found in the extended version of this work \citep{kim2021convergence}. -->
<p><strong>Proposition 1 (GD)</strong><sup id="fnref:14"><a href="#fn:14" class="footnote-ref" role="doc-noteref">14</a></sup>
<em>To minimize \eqref{eq:obj-quad} with gradient descent, the step size $\eta$ needs to satisfy $0 &lt; \eta &lt; \frac{2}{\lambda_i}~~\forall i$, where $\lambda_i$ is the $i$-th eigenvalue of $A$</em>.</p>
<p><strong>Proposition 2 (PPA)</strong><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>
<em>To minimize \eqref{eq:obj-quad} with PPA, the step size $\eta$ needs to satisfy</em> $\left| \frac{1}{1+\eta \lambda_i} \right| &lt; 1~~\forall i$.</p>
<p><strong>Proposition 3 (GDM)</strong><sup id="fnref:14"><a href="#fn:14" class="footnote-ref" role="doc-noteref">14</a></sup>
<em>To minimize \eqref{eq:obj-quad} with gradient descent with momentum, the step size $\eta$ needs to satisfy $0 &lt; \eta \lambda_i &lt; 2 + 2\beta$ ~ $\forall i$, where $0 \leq \beta &lt; 1.$</em></p>
<p><strong>Proposition 4 (PPAM)</strong><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>
<em>Let $\delta_i = \left( \frac{\beta+1}{1+\eta \lambda_i} \right)^2 - \frac{4\beta}{1+\eta \lambda_i}.$
To minimize \eqref{eq:obj-quad} with PPAM, the step size $\eta$ and momentum $\beta$ need to satisfy $~\forall i$:</em></p>
<ul>
<li>$\eta &gt; \frac{\beta-1}{\lambda_i},\quad$ if $\delta_i \leq 0$;</li>
<li>$\frac{\beta+1}{1+\eta \lambda_i} + \sqrt{\delta_i} &lt; 2,\quad$ if $\delta_i &gt; 0$ and $\frac{\beta+1}{1+\eta \lambda_i} \geq 0$;</li>
<li>$\frac{\beta+1}{1+\eta \lambda_i} - \sqrt{\delta_i} &gt; -2,\quad$ otherwise.</li>
</ul>






  



  
  











<figure id="figure-we-generate-a-in-mathbbrptimes-p-and-b-xstar-inmathbbrp-from-mathcaln0-i-where-p100-and-the-condition-number-of-a-is-10-we-sweep-eta-and-beta-from--5-to-5-with-02-interval-we-plot-the-accuracy-x_t---xstar_22-after-100-iterations-with-the-maximum-replaced-by-10">


  <a data-fancybox="" href="/blog/sppam/quadratic-model_hu7ea8cb333b3b20abe999ce52ffba51b9_61870_2000x2000_fit_lanczos_2.png" data-caption="We generate $A \in \mathbb{R}^{p\times p}$ and $b, x^\star \in\mathbb{R}^p$ from $\mathcal{N}(0, I)$, where $p=100$ and the condition number of $A$ is 10. We sweep $\eta$ and $\beta$ from $-5$ to $5$, with $0.2$ interval. We plot the accuracy $||x_t - x^\star||_2^2$ after 100 iterations, with the maximum replaced by 10.">


  <img data-src="/blog/sppam/quadratic-model_hu7ea8cb333b3b20abe999ce52ffba51b9_61870_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="100%" height="239">
</a>


  
  
  <figcaption>
    We generate $A \in \mathbb{R}^{p\times p}$ and $b, x^\star \in\mathbb{R}^p$ from $\mathcal{N}(0, I)$, where $p=100$ and the condition number of $A$ is 10. We sweep $\eta$ and $\beta$ from $-5$ to $5$, with $0.2$ interval. We plot the accuracy $||x_t - x^\star||_2^2$ after 100 iterations, with the maximum replaced by 10.
  </figcaption>


</figure>

<p>Given the above propositions, we can study the stability with respect to the step size $\eta$ and the momentum $\beta$ for the considered algorithms.
Numerical simulations support the above propositions, and are illustrated in the above figure, matching the theoretical conditions exhibited above.</p>
<p>In particular, for GD, only a small range of step sizes $\eta$ leads to convergence (small white band); this &ldquo;white band&rdquo; corresponds to the restriction that $\eta$ has to satisfy $\eta &lt; \tfrac{2}{\lambda_i}$ for all $i$.
On the other hand, PPA/IGD converges in much wider choices of $\eta$; this is apparent from Proposition 2, since $\left| \frac{1}{1+\eta \lambda_i} \right|$ can be arbitrarily small for larger values of $\eta$.
GDM requires both $\eta$ and $\beta$ to be in a small region to converge, following Proposition 3.
Finally, PPAM converges in much wider choices of $\eta$ and $\beta$; e.g., the conditions in Proposition 4 define different regions of the pair $(\eta, \beta)$ that lead to convergence, some of which set both $\eta$ and $\beta$ to be negative.
Note that the empirical convergence region of PPAM almost exactly matches the theoretical region that leads to convergence in Proposition 4.</p>
<p>In the next section, we will see how this pattern translates to a general strongly convex function $f,$ with stochasticity.</p>
<!-- In the remainder of the paper, we study how such pattern translates to a general strongly convex function $f,$ with stochasticity. -->
<h2 id="main-results">Main Results</h2>
<p>In this section, we theoretically characterize the convergence and stability behavior of SPPAM.</p>
<p>We follow the stochastic errors of PPA, as set up in <a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssb.12405" target="_blank" rel="noopener">this paper</a>.<sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup>
We can then express \eqref{eq:acc-stoc-ppa} as:
\begin{align*}
x_{t+1}^+ &amp;= x_t - \eta \nabla f(x_{t+1}^+) + \beta (x_t - x_{t-1})  \\<br>
x_{t+1} &amp;= x_{t+1}^+ - \eta  \varepsilon_{t+1}.
\end{align*}</p>
<p>Note that $x_{t+1}^+$ is an auxiliary intermediate variable that is used for the analysis only.</p>
<p>We further assume the following:</p>
<p><strong>Assumption 1</strong> <em>$f$ is a $\mu$-strongly convex function: for some fixed $\mu &gt; 0$ and for all $x$ and $y$,</em>
\begin{align*}
\langle \nabla f(x)-\nabla f(y), x - y \rangle \geq \mu ||x-y ||_2^2.
\end{align*}</p>
<p><strong>Assumption 2</strong> <em>There exists fixed $\sigma^2 &gt; 0$ such that, given the natural filtration $\mathcal{F}_{t-1},$</em>
\begin{align*}
\mathbb{E}\left[ \varepsilon_t \mid \mathcal{F}_{t-1} \right] = 0 \quad\text{and}\quad
\mathbb{E}\left[ | \varepsilon_t \mid \mathcal{F}_{t-1} |^2 \right] \leq \sigma^2
\quad\text{for all}\quad t.
\end{align*}</p>
<h3 id="is-sppam-faster-than-sppa">Is SPPAM faster than SPPA?</h3>
<p>We first study whether SPPAM enjoys faster convergence than SPPA. We start with the iteration invariant bound, which expresses the expected error at $x_{t+1}$ in terms of its previous iterates:</p>
<p><strong>Theorem 5</strong>
<em>For $\mu$-strongly convex $f(\cdot)$, SPPAM satisfies the following iteration invariant bound</em>:
\begin{align} \label{eq:onestep-acc-stoc-prox} \tag{11}
\mathbb{E} \big[ || x_{t+1 }- x^\star ||_2^2 \big] &amp;\leq \tfrac{4}{(1+\eta \mu)^2} \mathbb{E} \big[ ||x_t - x^\star ||_2^2 \big] \\<br>
&amp;\quad+ \tfrac{4\beta^2}{(1+\eta \mu)^2\left( 4-(1+\beta)^2 \right)} \mathbb{E} \big[ ||x_{t-1} - x^\star ||_2^2 \big] + \eta^2 \sigma^2.
\end{align}</p>
<p>Notice that all terms &ndash;except the last one&ndash; are divided by $(1+\eta \mu)^2.$
Thus, large step sizes $\eta$ help convergence (to a neighborhood), reminiscent of the convergence behavior of PPA in \eqref{eq:ppm-conv-rate-guller}.</p>
<p>Based on \eqref{eq:onestep-acc-stoc-prox},
we can write the following $2\times 2$ system that characterizes the progress of SPPAM:
\begin{align}
\label{eq:two-by-two-onestep} \tag{12}
\begin{bmatrix}
\mathbb{E} \big[ ||x_{t+1} - x^\star ||_2^2 \big] \\<br>
\mathbb{E} \big[ ||x_t - x^\star ||_2^2 \big]
\end{bmatrix} &amp;\leq
A
\cdot
\begin{bmatrix}
\mathbb{E} \big[ ||x_t - x^\star ||_2^2 \big] \\<br>
\mathbb{E} \big[ ||x_{t-1} - x^\star ||_2^2 \big]
\end{bmatrix}
+
\begin{bmatrix}
\eta^2 \sigma^2 \\<br>
0
\end{bmatrix},
\end{align}</p>
<p>where $A =
\begin{bmatrix}
\frac{4}{(1+\eta \mu)^2} &amp; \frac{4\beta^2}{(1+\eta \mu)^2\left( 4-(1+\beta)^2 \right)} \\<br>
1 &amp; 0
\end{bmatrix}$.
It is clear that the spectrum of the contraction matrix $A$ determines the convergence rate to a neighborhood.
This is summarized in the following lemma:</p>
<p><strong>Lemma 6</strong>
<em>The maximum eigenvalue of $A$, which determines the convergence rate of SPPAM, is</em>:
\begin{align} \label{eq:acc-stoc-ppa-conv-rate} \tag{13}
\tfrac{2}{(1+\eta \mu)^2} + \sqrt{ \tfrac{4}{(1+\eta \mu)^4} + \tfrac{4\beta^2}{(1+\eta \mu)^2(4 - (1+\beta)^2)}}.
\end{align}</p>
<p>Notice the one-step contraction factor in \eqref{eq:acc-stoc-ppa-conv-rate} is of order $O(1/\eta^2),$ exhibiting acceleration compared to that of SPPA for strongly convex objectives: $1/(1+2\eta \mu) \approx O(1/\eta).$<sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup></p>
<p>However, due to the additional terms, it is not immediately obvious when SPPAM enjoys faster convergence than SPPA. We thus characterize this condition more precisely in the following corollary:</p>
<p><strong>Corollary 7</strong>
<em>For $\mu$-strongly convex $f$, SPPAM enjoys better contraction factor than SPPA if</em>:
\begin{align*}
\frac{4\beta^2}{4 - (1+\beta)^2} &lt;  \frac{\eta^2 \mu^2 - 6\eta\mu - 3}{(1+\eta \mu)^2}.
\end{align*}</p>
<p>In words, for a fixed step size $\eta$ and given a strongly convex parameter $\mu$, there is a range of momentum parameters $\beta$ that exhibits acceleration compared to SPPA.</p>
<p>In contrast to (stochastic) gradient method analyses in convex optimization, where acceleration is usually shown by improving the dependency on the condition number from $\kappa = \tfrac{L}{\mu}$ to $\sqrt{\kappa},$ such a claim can hardly be made for stochastic proximal point methods. This is also the case in deterministic setting, where (Nesterov&rsquo;s) accelerated PPA converges for strongly convex $f$ as in:<sup id="fnref:15"><a href="#fn:15" class="footnote-ref" role="doc-noteref">15</a></sup>
\begin{align}
f(x_T) - f(x^\star) \leq O \left( \frac{1}{ \big( \sum_{t=1}^T \sqrt{\eta_t} \big)^2} \right), \label{eq:ppm-acc-conv-rate-guller} \tag{14}
\end{align}
which is faster than the rate in \eqref{eq:ppm-conv-rate-guller}.</p>
<!-- see \eqref{eq:ppm-conv-rate-guller} and \eqref{eq:ppm-acc-conv-rate-guller}.  -->
<p>As shown in Theorem 5, our convergence analysis of SPPAM does not depend on $L$-smoothness at all. This robustness of SPPAM is also confirmed in numerical simulations in the next section, where SPPAM exhibits the fastest convergence rate, virtually independent of the different settings considered.</p>
<!-- We now formalize the convergence behavior of SPPAM.
In particular, we characterize the condition that leads to an exponential discount of the initial conditions.
By unrolling the recursion of SPPAM in \eqref{eq:two-by-two-onestep} for $T$ iterations, we obtain:  -->
<h3 id="is-sppam-more-stable-than-sgdm">Is SPPAM more stable than SGDM?</h3>
<p><strong>Theorem 9</strong>
<em>For $\mu$-strongly convex $f$, assume SPPAM is initialized with</em> $x_0 = x_{-1}$. Then, after $T$ iterations, we have:
\begin{align}  \label{eq:Tstep-acc-stoc-prox} \tag{15}
&amp;\mathbb{E} \big[ ||x_T - x^\star ||_2^2 \big]
\leq  \frac{2 \sigma_1^T}{\sigma_1 - \sigma_2}
%
\left(  \left( ||x_0-x^\star ||_2^2 + \tfrac{\eta^2 \sigma^2}{1-\theta}\right) \cdot (1+\theta) \right)<br>
+
\frac{\eta^2 \sigma^2}{1-\theta},
\end{align}
where
$\theta=\frac{4}{(1+\eta\mu)^2} + \tfrac{4\beta^2}{(1+\eta\mu)^2(4-(1+\beta)^2)}.$</p>
<p>Here, $\sigma_{1, 2}$ are the eigenvalues of $A$, and
\begin{align} \label{eq:discount-init} \tag{16}
\tfrac{2 \sigma_1^T}{\sigma_1 - \sigma_2}  =  \tau^{-1}
\cdot
\left( \tfrac{2}{(1+\eta\mu)^2} + \tau \right)^T
\quad \text{with} \quad
\tau = \sqrt{ \tfrac{4}{(1+\eta \mu)^4} + \tfrac{4\beta^2}{(1+\eta \mu)^2(4 - (1+\beta)^2)}}.
\end{align}</p>
<p>The above theorem states that the term in \eqref{eq:discount-init} determines the discounting rate of the initial conditions.
In particular, the condition that leads to an exponential discount
of the initial conditions
is characterized by the following theorem:</p>
<p><strong>Theorem 10</strong>
<em>Let the following condition hold</em>:
\begin{align} \label{eq:init-discount-condition} \tag{17}
% \left( \frac{1-\beta}{1+2 \eta \mu} \right)^2 + \frac{\beta^2}{1+2\eta \mu} \left( \frac{2-\beta}{2-\beta(1+\beta)} \right) &lt; \frac{1}{4}.
\tau = \sqrt{ \tfrac{4}{(1+\eta \mu)^4} + \tfrac{4\beta^2}{(1+\eta \mu)^2(4 - (1+\beta)^2)}} &lt; \tfrac{1}{2}.
\end{align}
<em>Then, for $\mu$-strongly convex $f$, initial conditions of SPPAM exponentially discount: i.e., in \eqref{eq:Tstep-acc-stoc-prox}</em>,<br>
\begin{align*}
\tfrac{2 \sigma_1^T}{\sigma_1 - \sigma_2}  =
\tau^{-1} \cdot   \left( \tfrac{2}{(1+\eta\mu)^2} + \tau \right)^T
=C^T, \quad\text{where}\quad C \in (0, 1).
\end{align*}</p>
<p>To provide more context of the condition in <strong>Theorem 10</strong>, we make an ``unfair&quot; comparison of  \eqref{eq:init-discount-condition}, which holds for general strongly convex $f,$ to the condition that accelerated SGD requires for strongly convex <em>quadratic objective</em> in \eqref{eq:obj-quad}.</p>
<p><a href="https://proceedings.mlr.press/v119/assran20a.html" target="_blank" rel="noopener">This paper</a>
shows that Nesterov&rsquo;s accelerated SGD converges to a neighborhood at a linear rate for strongly convex quadratic objective if
$\max{ \rho_\mu(\eta, \beta),~\rho_L(\eta, \beta) } &lt; 1$,
where $\rho_\lambda(\eta, \beta)$ for $\lambda \in {\mu, L}$ is defined as:
\begin{align} \label{eq:sgdm-spectral-rad}
\rho_\lambda(\eta, \beta) =
\begin{cases}
\frac{|(1+\beta)(1-\eta \lambda)|}{2} + \frac{\sqrt{\Delta_\lambda}}{2} &amp; \text{if}~\Delta_\lambda \geq 0, \<br>
\sqrt{\beta (1-\eta \lambda)} &amp; \text{otherwise},
\end{cases}
\end{align}
with $\Delta_\lambda = (1+\beta)^2 (1-\eta \lambda)^2 - 4\beta(1-\eta \lambda)$.
This condition for convergence can thus be divided into three cases, depending on the range of $\eta \lambda$.
Define $\psi_{\beta, \eta, \lambda} = (1 + \beta)(1 - \eta \lambda)$. Then:
\begin{align*}
\begin{cases}
\eta \lambda \geq 1, &amp;  \text{Converges if }-\psi_{\beta, \eta, \lambda} + \sqrt{\Delta_\lambda} &lt; 2, \\
\frac{(1-\beta)^2}{(1+\beta)^2} \leq \eta \lambda &lt; 1,
&amp; \text{Always converges}, \\<br>
\eta \lambda &lt; \frac{(1-\beta)^2}{(1+\beta)^2}, &amp;\text{Converges if }\psi_{\beta, \eta, \lambda} + \sqrt{\Delta_\lambda}&lt; 2 .
\end{cases}
\end{align*}</p>
<p>Now, consider the standard momentum value $\beta = 0.9.$
For the first case, the convergence requirement translates to
$1 \leq \eta \lambda \leq \tfrac{24}{19}.$
The second range is given by $\frac{1}{361} \leq \eta \lambda &lt; 1$.
The third condition is lower bounded by 2 for $\beta=0.9,$ leading to divergence.
Combining, accelerated SGD requires $0.0028 \approx \frac{1}{361} \leq \eta \lambda \leq \frac{24}{19} \approx 1.26$ to converge for strongly convex quadratic objectives, set aside that this bound has to satisfy for (unknown) $\mu$ or $L$.
Albeit an unfair comparison, for general strongly convex objective, \eqref{eq:init-discount-condition} becomes $\eta \mu &gt; 4.81$ for $\beta=0.9.$
Even though $\mu$ is unknown, one can see this condition is easy to satisfy, by using a sufficiently large step size $\eta$.</p>
<h2 id="experiments">Experiments</h2>
<p>In this section, we perform numerical experiments to study the convergence behaviors of SPPAM, SPPA, SGDM, and SGD, using generalized linear models (GLM).</p>
<!-- {\cite{nelder1972generalized}}.  -->
<!-- Let $b_i \in \mathbb{R}$ be the label, $a_i \in \mathbb{R}^{p}$ be the features, and $x^\star \in \mathbb{R}^p$ be the model parameter of interest. GLM assumes that $b_i$ follows an exponential family distribution: $b_i \mid a_i \sim \exp \left( \frac{\gamma b_i - c_1(\gamma)}{\omega} c_2(b_i, \omega)  \right).$ -->
<!-- Here, $\gamma=\langle a_i, x^\star \rangle$ is the linear predictor, $\omega$ is the dispersion parameter related to the variance of $b_i$, and $c_1(\cdot)$ and $c_2(\cdot)$ are known real-valued functions.  -->
<p>GLM subsumes a wide family of models including linear, logistic, and Poisson regressions. Different models connects the linear predictor $\gamma=\langle a_i, x^\star \rangle$ through different \textit{mean} functions $h(\cdot)$.
We focus on linear and Poisson regression models, where mean functions are defined respectively as $h(\gamma) = \gamma$ and $h(\gamma) = e^\gamma$.
The former is an &ldquo;easy&rdquo; case, where objective is strongly convex, satisfying Assumption 1. The latter is a &ldquo;hard&rdquo; case with non-Lipschitz continuous gradients, where SGD and SGDM are expected to suffer.</p>
<!-- {\cite{toulis_statistical_2014}} introduced an efficient, exact implementation of SPPA for GLM. We adapt this procedure to SPPAM in \eqref{eq:acc-stoc-ppa}; see Algorithm~\ref{alg:sppam-glm}. Its derivation can be found in \cite{kim2021convergence}. -->






  



  
  











<figure id="figure-top-linear-regression-with-condition-number-kappa-in-1-5-10-with-gaussian-noise-level-texttt1e-3-bottom-poisson-regression-with-condition-number-kappa-in-1-3-5-we-set-p--n--100-in-both-cases-batch-size-is-10-for-all-algorithms-the-median-number-of-iterations-to-reach-varepsilon--001-is-plotted-shaded-area-are-the-standard-deviations-across-5-experiments">


  <a data-fancybox="" href="/blog/sppam/normal-poisson_hubb8b80653c08a11bdd0af6bf6f9df321_313409_2000x2000_fit_lanczos_2.png" data-caption="TOP: Linear regression with condition number $\kappa \in {1, 5, 10}$ with gaussian noise level $\texttt{1e-3}.$ BOTTOM: Poisson regression with condition number $\kappa \in {1, 3, 5}$. We set $p = n = 100$ in both cases. Batch size is 10 for all algorithms. The median number of iterations to reach $\varepsilon = 0.01$ is plotted. Shaded area are the standard deviations across 5 experiments.">


  <img data-src="/blog/sppam/normal-poisson_hubb8b80653c08a11bdd0af6bf6f9df321_313409_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="100%" height="698">
</a>


  
  
  <figcaption>
    TOP: Linear regression with condition number $\kappa \in {1, 5, 10}$ with gaussian noise level $\texttt{1e-3}.$ BOTTOM: Poisson regression with condition number $\kappa \in {1, 3, 5}$. We set $p = n = 100$ in both cases. Batch size is 10 for all algorithms. The median number of iterations to reach $\varepsilon = 0.01$ is plotted. Shaded area are the standard deviations across 5 experiments.
  </figcaption>


</figure>

<!-- We generate the data as follows. $A \in \mathbb{R}^{p \times n}$ and $x^\star \in \mathbb{R}^p$ are drawn from $\mathcal{N}(0, I).$ For the normal case, we generate $b_i = \langle a_i, x^\star \rangle$, and for the Poisson case, we generate $b_i \sim \text{Poisson} (e^{\langle a_i, x^\star \rangle} )$ for $i = 1, \dots, n.$ 
For each experimental setup, we run SPPAM (blue), SPPA (orange), SGDM (green), and SGD (red) for $10^4$ iterations. 
We repeat each experiment for 5 independent trials, and 
plot the median number of iterations to reach precision $\varepsilon \leq 10^{-2},$ along with the standard deviation.
We measure the precision 
$\varepsilon = \frac{\|b - \hat{b}\|_2^2}{\|b\|_2^2},$ 
where $b$ is the true label and $\hat{b}$ is the predicted label. -->
<p>In the top row of above figure, we present the results for the linear regression with different condition numbers, with gaussian noise level $\texttt{1e-3}$. We run each algorithm constant step size $\eta$ varying from $10^{-3}$ to $10^3$ with $10\times$ increment, and with $\beta=0.9$.
As expected, SGD and SGDM only converge for specific step size $\eta$, while SPPA and SPPAM converge for much wider ranges.
In terms of convergence rate, SPPAM converges faster than SPPA in all scenarios, which improves or matches the rate of SGDM, when it converges.
As $\kappa$ increases, the range of $\eta$ that leads to convergence for SGD and SGDM shrinks; notice the sharper &ldquo;$\lor$&rdquo; shape for SGD and SGDM for $\kappa = 10$ (3rd), compared to $\kappa=5$ (2nd) or $\kappa=1$ (1st).
SPPA also slightly slows down as $\kappa$ increases, while SPPAM converges essentially in the same manner for all scenarios.</p>
<p>Such trend is much more pronounced for the Poisson regression case presented in the bottom row.
Due to the exponential mean function $h(\cdot)$ for Poisson model, the outcomes are extremely sensitive, and its likelihood does not satisfy standard assumptions like $L$-smoothness. As such, SGD and SGDM struggles with slow convergence even when $\kappa = 1$ (1st), while also exhibiting instability&mdash;each method converges only for a single choice of $\eta$ considered.
Similar trend is shown when $\kappa=3$ (2nd) where SPPA starts slowing down.
For $\kappa = 5$ (3rd), all methods except for SPPAM did not make much progress in $10^4$ iterations, for the entire range of $\eta$ and $\beta$ considered. Quite remarkably, SPPAM still converges in the same manner without sacrificing both the convergence rate and the range of hyperparameters that lead to convergence.</p>
<h2 id="conclusion">Conclusion</h2>
<p>We propose the stochastic proximal point algorithm with momentum (SPPAM), which directly incorporates Polyak&rsquo;s momentum inside the proximal step. We show that SPPAM converges to a neighborhood at a faster rate than stochastic proximal point algorithm (SPPA), and characterize the conditions that result in acceleration. Further, we prove linear convergence of SPPAM to a neighborhood, and provide conditions that lead to an exponential discount of the initial conditions, akin to SPPA. We confirm our theory with numerical simulations on linear and Poisson regression models; SPPAM converges for all the step sizes that SPPA converges, with a faster rate that matches or improves SGDM.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Junhyung Lyle Kim, Panos Toulis, and Anastasios Kyrillidis. Convergence and stability of the
stochastic proximal point algorithm with momentum. arXiv preprint arXiv:2111.06171, 2021. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Eric Moulines and Francis R. Bach. Non-Asymptotic Analysis of Stochastic Approximation Algorithms for Machine Learning. In J. Shawe-Taylor, R. S. Zemel, P. L. Bartlett, F. Pereira, and
K. Q. Weinberger, editors, Advances in Neural Information Processing Systems 24, pages 451–459. Curran Associates, Inc., 2011. <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>Robert M Gower, Nicolas Loizou, Xun Qian, Alibek Sailanbayev, Egor Shulgin, and Peter
Richtarik. SGD: General Analysis and Improved Rates. Proceedings of the 36 th International
Conference on Machine Learning, page 10, 2019. <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>Boris T Polyak. Some methods of speeding up the convergence of iteration methods. Ussr computational mathematics and mathematical physics, 4(5):1–17, 1964. <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p>Yurii Nesterov et al. Lectures on convex optimization, volume 137. Springer, 2018. <a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6" role="doc-endnote">
<p>Chaoyue Liu and Mikhail Belkin. Accelerating sgd with momentum for over-parameterized learning. arXiv preprint arXiv:1810.13395, 2018. <a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7" role="doc-endnote">
<p>Rahul Kidambi, Praneeth Netrapalli, Prateek Jain, and Sham Kakade. On the insufficiency of existing momentum schemes for stochastic optimization. In 2018 Information Theory and Applications Workshop (ITA), pages 1–9. IEEE, 2018. <a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8" role="doc-endnote">
<p>Mahmoud Assran and Michael Rabbat. On the Convergence of Nesterov’s Accelerated Gradient
Method in Stochastic Settings. Proceedings of the 37 th International Conference on Machine
Learning, 2020. <a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9" role="doc-endnote">
<p>Osman Guler. On the convergence of the proximal point algorithm for convex minimization. ¨ SIAM
journal on control and optimization, 29(2):403–419, 1991. <a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10" role="doc-endnote">
<p>Ernest K Ryu and Stephen Boyd. Stochastic Proximal Iteration: A Non-Asymptotic Improvement
Upon Stochastic Gradient Descent. Author website, page 42, 2017. <a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:11" role="doc-endnote">
<p>Hilal Asi and John C Duchi. Stochastic (approximate) proximal point methods: Convergence,
optimality, and adaptivity. SIAM Journal on Optimization, 29(3):2257–2290, 2019. <a href="#fnref:11" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:12" role="doc-endnote">
<p>Panos Toulis and Edoardo M Airoldi. Asymptotic and finite-sample properties of estimators based
on stochastic gradients. The Annals of Statistics, 45(4):1694–1727, 2017. <a href="#fnref:12" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:13" role="doc-endnote">
<p>Panos Toulis, Thibaut Horel, and Edoardo M Airoldi. The proximal robbins–monro method. Journal
of the Royal Statistical Society: Series B (Statistical Methodology), 83(1):188–212, 2021. <a href="#fnref:13" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:14" role="doc-endnote">
<p>Gabriel Goh. Why momentum really works. Distill, 2(4):e6, 2017. <a href="#fnref:14" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:15" role="doc-endnote">
<p>Osman Guler. New proximal point algorithms for convex minimization. ¨ SIAM Journal on Optimization, 2(4):649–664, 1992. <a href="#fnref:15" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/convex-optimization/">convex optimization</a>
  
  <a class="badge badge-light" href="/tag/acceleration/">acceleration</a>
  
  <a class="badge badge-light" href="/tag/proximal-point-algorithm/">proximal point algorithm</a>
  
</div>













  
  
    




  
















  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.4c2bca31150ce93c5a5e43b8a50f22fd.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © Copyright 2023 Junhyung Lyle Kim
  </p>

  
  






  <p class="powered-by">
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
